<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Terma Snapshot Gallery</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #1a1a2e;
      color: #eee;
      margin: 0;
      padding: 20px;
    }
    h1 { margin: 0 0 20px; color: #fff; }
    .toolbar {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      align-items: center;
    }
    .toolbar-group {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    .toolbar-label {
      font-size: 12px;
      color: #888;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .toolbar button {
      background: #2d2d44;
      border: none;
      color: #eee;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }
    .toolbar button:hover { background: #3d3d54; }
    .toolbar button.active { background: #5a5a8a; }
    .comparison {
      margin-bottom: 30px;
      padding: 20px;
      background: #2d2d44;
      border-radius: 8px;
    }
    .comparison.failed { border: 2px solid #ff4444; }
    .comparison.passed { border: 2px solid #44ff44; }
    .comparison-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 15px;
    }
    .comparison-name { font-size: 18px; font-weight: 600; }
    .comparison-description {
      font-size: 14px;
      color: #aaa;
      margin-bottom: 15px;
      line-height: 1.5;
    }
    .comparison.seen .comparison-description { display: none; }
    .status-badge {
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
    }
    .status-badge.passed { background: #44ff44; color: #000; }
    .status-badge.failed { background: #ff4444; color: #fff; }
    .stats {
      display: flex;
      gap: 15px;
      margin-left: auto;
      font-size: 15px;
      color: #aaa;
    }
    .stat {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .stat-value {
      font-weight: 600;
      color: #fff;
    }
    .stat-value.good { color: #44ff44; }
    .stat-value.bad { color: #ff4444; }

    /* Side-by-side view */
    .view-sidebyside .snapshots { display: flex; gap: 20px; }
    .view-sidebyside .snapshot-container { flex: 1; }
    .view-sidebyside .diff-view { display: none; }
    .snapshot-label { font-size: 14px; color: #aaa; margin-bottom: 8px; }
    .snapshot {
      background: #1a1a2e;
      border-radius: 4px;
      overflow: hidden;
    }
    .snapshot svg { display: block; max-width: 100%; height: auto; }

    /* Overlay view */
    .view-overlay .snapshots { display: none; }
    .view-overlay .diff-view { display: block; }
    .diff-view { display: none; }
    .diff-layers { position: relative; display: inline-block; }
    .diff-layers .expected-layer,
    .diff-layers .actual-layer {
      border-radius: 4px;
      overflow: hidden;
      background: #1a1a2e;
    }
    .diff-layers .expected-layer { position: relative; }
    .diff-layers .actual-layer {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0.5;
      pointer-events: none;
    }
    .diff-layers svg { display: block; max-width: 100%; height: auto; }
    .diff-controls {
      margin-top: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .diff-controls label { font-size: 14px; color: #aaa; }
    .diff-controls input[type="range"] { flex: 1; max-width: 300px; }

    /* Slider view */
    .view-slider .snapshots { display: none; }
    .view-slider .diff-view { display: block; }
    .view-slider .diff-layers .actual-layer {
      opacity: 1;
      clip-path: inset(0 50% 0 0);
      transition: none;
    }
    .view-slider .diff-controls { display: block; }
    .slider-label { font-size: 12px; color: #666; }

    /* Difference blend mode */
    .view-difference .snapshots { display: none; }
    .view-difference .diff-view { display: block; }
    .view-difference .diff-layers .actual-layer {
      opacity: 1;
      mix-blend-mode: difference;
    }
    .view-difference .diff-controls { display: none; }

    /* Highlight mode - shows diff SVG */
    .view-highlight .snapshots { display: none; }
    .view-highlight .diff-view { display: none; }
    .view-highlight .highlight-view { display: block; }
    .highlight-view { display: none; }
    .highlight-view .snapshot {
      background: #1a1a2e;
      border-radius: 4px;
      overflow: hidden;
      display: inline-block;
    }
    .highlight-view svg { display: block; }

    .hidden { display: none !important; }
    .help-text {
      font-size: 12px;
      color: #666;
    }

    /* Seen/minimized state */
    .comparison.seen .snapshots,
    .comparison.seen .diff-view,
    .comparison.seen .highlight-view { display: none !important; }
    .comparison.seen { padding: 12px 20px; }
    .seen-btn {
      background: transparent;
      border: 1px solid #555;
      color: #888;
      padding: 4px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      margin-left: auto;
    }
    .seen-btn:hover { background: #3d3d54; border-color: #777; color: #ccc; }
    .comparison.seen .seen-btn { background: #3d3d54; border-color: #5a5a8a; color: #aaa; }
    .comparison.seen .seen-btn:hover { background: #4d4d64; }
    .header-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    .summary {
      display: flex;
      gap: 15px;
      font-size: 15px;
    }
    .summary-item {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .summary-count {
      font-weight: 700;
      font-size: 18px;
    }
    .summary-count.passed { color: #44ff44; }
    .summary-count.failed { color: #ff4444; }
  </style>
</head>
<body data-gallery-id="5e48064cddded6b6">
  <div class="header-bar">
    <h1 style="margin: 0;">Terma Snapshot Gallery</h1>
    <div class="summary">
      <div class="summary-item" style="color: #888;">2026-02-14 00:41:16</div>
      <div class="summary-item"><span class="summary-count passed">1</span> passed</div>
      <div class="summary-item"><span class="summary-count failed">0</span> failed</div>
    </div>
  </div>
  <div class="toolbar">
    <div class="toolbar-group">
      <span class="toolbar-label">Filter:</span>
      <button class="filter-btn" data-filter="failed">Failed</button>
      <button class="filter-btn" data-filter="passed">Passed</button>
      <button class="filter-btn active" data-filter="all">All</button>
    </div>
    <div class="toolbar-group">
      <span class="toolbar-label">View:</span>
      <button class="view-btn active" data-view="sidebyside">Side by Side</button>
      <button class="view-btn" data-view="overlay">Overlay</button>
      <button class="view-btn" data-view="slider">Slider</button>
      <button class="view-btn" data-view="difference">Difference</button>
      <button class="view-btn" data-view="highlight">Highlight</button>
    </div>
    <span class="help-text">Difference mode: black = identical, colored = different</span>
  </div>
  <div class="comparison passed view-sidebyside" data-status="passed" data-index="0" data-name="TestSnapshot_ThemeInheritance_ExtendedTheme">
    <div class="comparison-header">
      <span class="comparison-name">TestSnapshot_ThemeInheritance_ExtendedTheme</span>
      <span class="status-badge passed">PASSED</span>
      <button class="seen-btn">Mark as seen</button>
    </div>
    <div class="comparison-description">Theme inheritance demo: dark blue background (#000033), Primary button in bright RED (#ff0000), Accent button in bright GREEN (#00ff00), Success button in YELLOW (#ffff00), Error button in MAGENTA (#ff00ff). These colors prove ExtendTheme modified the base dracula theme.</div>
    <div class="snapshots">
      <div class="snapshot-container">
        <div class="snapshot-label">Expected</div>
        <div class="snapshot expected">
          <svg xmlns="http://www.w3.org/2000/svg" width="352" height="232" viewBox="0 0 352 232">
            <style>
              @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&amp;display=swap');
              text { font-family: Fira Code, Menlo, Monaco, Consolas, monospace; font-size: 14px; dominant-baseline: text-before-edge; }
              .bold { font-weight: bold; }
              .italic { font-style: italic; }
              .underline { text-decoration: underline; }
              .strikethrough { text-decoration: line-through; }
            </style>
            <rect width="100%" height="100%" fill="#000000"/>
            <text x="16.4" y="27.6" class="bold" fill="#F8F8F2">Extended</text>
            <text x="92.0" y="27.6" class="bold" fill="#F8F8F2">Theme</text>
            <text x="142.4" y="27.6" class="bold" fill="#F8F8F2">Test</text>
            <rect x="16.4" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="24.8" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="33.2" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="41.6" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="50.0" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="58.4" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="66.8" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="75.2" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="83.6" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="100.4" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
            <rect x="108.8" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
            <rect x="117.2" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
            <rect x="125.6" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
            <rect x="134.0" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
            <rect x="142.4" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
            <rect x="150.8" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
            <rect x="159.2" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
            <text x="16.4" y="66.8" fill="#9E1218">[</text>
            <text x="24.8" y="66.8" fill="#282A36">Primary</text>
            <text x="83.6" y="66.8" fill="#9E1218">]</text>
            <text x="100.4" y="66.8" fill="#06DF08">[</text>
            <text x="108.8" y="66.8" fill="#282A36">Accent</text>
            <text x="159.2" y="66.8" fill="#06DF08">]</text>
            <rect x="16.4" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="24.8" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="33.2" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="41.6" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="50.0" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="58.4" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="66.8" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="75.2" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="83.6" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="100.4" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
            <rect x="108.8" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
            <rect x="117.2" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
            <rect x="125.6" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
            <rect x="134.0" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
            <rect x="142.4" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
            <rect x="150.8" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
            <text x="16.4" y="106.0" fill="#DEDF08">[</text>
            <text x="24.8" y="106.0" fill="#282A36">Success</text>
            <text x="83.6" y="106.0" fill="#DEDF08">]</text>
            <text x="100.4" y="106.0" fill="#DE06E0">[</text>
            <text x="108.8" y="106.0" fill="#282A36">Error</text>
            <text x="150.8" y="106.0" fill="#DE06E0">]</text>
          </svg>
        </div>
      </div>
      <div class="snapshot-container">
        <div class="snapshot-label">Actual</div>
        <div class="snapshot actual">
          <svg xmlns="http://www.w3.org/2000/svg" width="352" height="232" viewBox="0 0 352 232">
            <style>
              @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&amp;display=swap');
              text { font-family: Fira Code, Menlo, Monaco, Consolas, monospace; font-size: 14px; dominant-baseline: text-before-edge; }
              .bold { font-weight: bold; }
              .italic { font-style: italic; }
              .underline { text-decoration: underline; }
              .strikethrough { text-decoration: line-through; }
            </style>
            <rect width="100%" height="100%" fill="#000000"/>
            <text x="16.4" y="27.6" class="bold" fill="#F8F8F2">Extended</text>
            <text x="92.0" y="27.6" class="bold" fill="#F8F8F2">Theme</text>
            <text x="142.4" y="27.6" class="bold" fill="#F8F8F2">Test</text>
            <rect x="16.4" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="24.8" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="33.2" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="41.6" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="50.0" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="58.4" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="66.8" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="75.2" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="83.6" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
            <rect x="100.4" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
            <rect x="108.8" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
            <rect x="117.2" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
            <rect x="125.6" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
            <rect x="134.0" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
            <rect x="142.4" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
            <rect x="150.8" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
            <rect x="159.2" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
            <text x="16.4" y="66.8" fill="#9E1218">[</text>
            <text x="24.8" y="66.8" fill="#282A36">Primary</text>
            <text x="83.6" y="66.8" fill="#9E1218">]</text>
            <text x="100.4" y="66.8" fill="#06DF08">[</text>
            <text x="108.8" y="66.8" fill="#282A36">Accent</text>
            <text x="159.2" y="66.8" fill="#06DF08">]</text>
            <rect x="16.4" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="24.8" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="33.2" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="41.6" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="50.0" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="58.4" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="66.8" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="75.2" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="83.6" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
            <rect x="100.4" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
            <rect x="108.8" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
            <rect x="117.2" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
            <rect x="125.6" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
            <rect x="134.0" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
            <rect x="142.4" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
            <rect x="150.8" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
            <text x="16.4" y="106.0" fill="#DEDF08">[</text>
            <text x="24.8" y="106.0" fill="#282A36">Success</text>
            <text x="83.6" y="106.0" fill="#DEDF08">]</text>
            <text x="100.4" y="106.0" fill="#DE06E0">[</text>
            <text x="108.8" y="106.0" fill="#282A36">Error</text>
            <text x="150.8" y="106.0" fill="#DE06E0">]</text>
          </svg>
        </div>
      </div>
    </div>
    <div class="diff-view">
      <div class="snapshot-label"><span class="diff-mode-label">Overlay</span>: Expected + Actual</div>
      <div class="diff-layers">
        <div class="expected-layer">
        <svg xmlns="http://www.w3.org/2000/svg" width="352" height="232" viewBox="0 0 352 232">
          <style>
            @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&amp;display=swap');
            text { font-family: Fira Code, Menlo, Monaco, Consolas, monospace; font-size: 14px; dominant-baseline: text-before-edge; }
            .bold { font-weight: bold; }
            .italic { font-style: italic; }
            .underline { text-decoration: underline; }
            .strikethrough { text-decoration: line-through; }
          </style>
          <rect width="100%" height="100%" fill="#000000"/>
          <text x="16.4" y="27.6" class="bold" fill="#F8F8F2">Extended</text>
          <text x="92.0" y="27.6" class="bold" fill="#F8F8F2">Theme</text>
          <text x="142.4" y="27.6" class="bold" fill="#F8F8F2">Test</text>
          <rect x="16.4" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="24.8" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="33.2" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="41.6" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="50.0" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="58.4" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="66.8" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="75.2" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="83.6" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="100.4" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="108.8" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="117.2" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="125.6" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="134.0" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="142.4" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="150.8" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="159.2" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <text x="16.4" y="66.8" fill="#9E1218">[</text>
          <text x="24.8" y="66.8" fill="#282A36">Primary</text>
          <text x="83.6" y="66.8" fill="#9E1218">]</text>
          <text x="100.4" y="66.8" fill="#06DF08">[</text>
          <text x="108.8" y="66.8" fill="#282A36">Accent</text>
          <text x="159.2" y="66.8" fill="#06DF08">]</text>
          <rect x="16.4" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="24.8" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="33.2" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="41.6" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="50.0" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="58.4" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="66.8" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="75.2" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="83.6" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="100.4" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="108.8" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="117.2" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="125.6" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="134.0" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="142.4" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="150.8" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <text x="16.4" y="106.0" fill="#DEDF08">[</text>
          <text x="24.8" y="106.0" fill="#282A36">Success</text>
          <text x="83.6" y="106.0" fill="#DEDF08">]</text>
          <text x="100.4" y="106.0" fill="#DE06E0">[</text>
          <text x="108.8" y="106.0" fill="#282A36">Error</text>
          <text x="150.8" y="106.0" fill="#DE06E0">]</text>
        </svg>
        </div>
        <div class="actual-layer">
        <svg xmlns="http://www.w3.org/2000/svg" width="352" height="232" viewBox="0 0 352 232">
          <style>
            @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&amp;display=swap');
            text { font-family: Fira Code, Menlo, Monaco, Consolas, monospace; font-size: 14px; dominant-baseline: text-before-edge; }
            .bold { font-weight: bold; }
            .italic { font-style: italic; }
            .underline { text-decoration: underline; }
            .strikethrough { text-decoration: line-through; }
          </style>
          <rect width="100%" height="100%" fill="#000000"/>
          <text x="16.4" y="27.6" class="bold" fill="#F8F8F2">Extended</text>
          <text x="92.0" y="27.6" class="bold" fill="#F8F8F2">Theme</text>
          <text x="142.4" y="27.6" class="bold" fill="#F8F8F2">Test</text>
          <rect x="16.4" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="24.8" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="33.2" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="41.6" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="50.0" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="58.4" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="66.8" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="75.2" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="83.6" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="100.4" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="108.8" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="117.2" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="125.6" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="134.0" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="142.4" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="150.8" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="159.2" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <text x="16.4" y="66.8" fill="#9E1218">[</text>
          <text x="24.8" y="66.8" fill="#282A36">Primary</text>
          <text x="83.6" y="66.8" fill="#9E1218">]</text>
          <text x="100.4" y="66.8" fill="#06DF08">[</text>
          <text x="108.8" y="66.8" fill="#282A36">Accent</text>
          <text x="159.2" y="66.8" fill="#06DF08">]</text>
          <rect x="16.4" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="24.8" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="33.2" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="41.6" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="50.0" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="58.4" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="66.8" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="75.2" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="83.6" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="100.4" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="108.8" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="117.2" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="125.6" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="134.0" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="142.4" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="150.8" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <text x="16.4" y="106.0" fill="#DEDF08">[</text>
          <text x="24.8" y="106.0" fill="#282A36">Success</text>
          <text x="83.6" y="106.0" fill="#DEDF08">]</text>
          <text x="100.4" y="106.0" fill="#DE06E0">[</text>
          <text x="108.8" y="106.0" fill="#282A36">Error</text>
          <text x="150.8" y="106.0" fill="#DE06E0">]</text>
        </svg>
        </div>
      </div>
      <div class="diff-controls">
        <label class="slider-label-text">Actual opacity:</label>
        <input type="range" min="0" max="100" value="50" class="opacity-slider">
        <span class="opacity-value">50%</span>
      </div>
    </div>
    <div class="highlight-view">
      <div class="snapshot-label">Snapshot (no differences to highlight)</div>
      <div class="snapshot">
        <svg xmlns="http://www.w3.org/2000/svg" width="352" height="232" viewBox="0 0 352 232">
          <style>
            @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&amp;display=swap');
            text { font-family: Fira Code, Menlo, Monaco, Consolas, monospace; font-size: 14px; dominant-baseline: text-before-edge; }
            .bold { font-weight: bold; }
            .italic { font-style: italic; }
            .underline { text-decoration: underline; }
            .strikethrough { text-decoration: line-through; }
          </style>
          <rect width="100%" height="100%" fill="#000000"/>
          <text x="16.4" y="27.6" class="bold" fill="#F8F8F2">Extended</text>
          <text x="92.0" y="27.6" class="bold" fill="#F8F8F2">Theme</text>
          <text x="142.4" y="27.6" class="bold" fill="#F8F8F2">Test</text>
          <rect x="16.4" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="24.8" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="33.2" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="41.6" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="50.0" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="58.4" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="66.8" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="75.2" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="83.6" y="66.8" width="8.4" height="19.6" fill="#FF0000"/>
          <rect x="100.4" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="108.8" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="117.2" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="125.6" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="134.0" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="142.4" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="150.8" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <rect x="159.2" y="66.8" width="8.4" height="19.6" fill="#00FF00"/>
          <text x="16.4" y="66.8" fill="#9E1218">[</text>
          <text x="24.8" y="66.8" fill="#282A36">Primary</text>
          <text x="83.6" y="66.8" fill="#9E1218">]</text>
          <text x="100.4" y="66.8" fill="#06DF08">[</text>
          <text x="108.8" y="66.8" fill="#282A36">Accent</text>
          <text x="159.2" y="66.8" fill="#06DF08">]</text>
          <rect x="16.4" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="24.8" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="33.2" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="41.6" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="50.0" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="58.4" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="66.8" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="75.2" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="83.6" y="106.0" width="8.4" height="19.6" fill="#FFFF00"/>
          <rect x="100.4" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="108.8" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="117.2" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="125.6" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="134.0" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="142.4" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <rect x="150.8" y="106.0" width="8.4" height="19.6" fill="#FF00FF"/>
          <text x="16.4" y="106.0" fill="#DEDF08">[</text>
          <text x="24.8" y="106.0" fill="#282A36">Success</text>
          <text x="83.6" y="106.0" fill="#DEDF08">]</text>
          <text x="100.4" y="106.0" fill="#DE06E0">[</text>
          <text x="108.8" y="106.0" fill="#282A36">Error</text>
          <text x="150.8" y="106.0" fill="#DE06E0">]</text>
        </svg>
      </div>
    </div>
  </div>
  <script>
    // Filter buttons
    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const filter = btn.dataset.filter;
        document.querySelectorAll('.comparison').forEach(el => {
          if (filter === 'all') {
            el.classList.remove('hidden');
          } else {
            el.classList.toggle('hidden', el.dataset.status !== filter);
          }
        });
      });
    });

    // View mode buttons
    document.querySelectorAll('.view-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const view = btn.dataset.view;
        document.querySelectorAll('.comparison').forEach(el => {
          el.classList.remove('view-sidebyside', 'view-overlay', 'view-slider', 'view-difference', 'view-highlight');
          el.classList.add('view-' + view);

          // Update mode label
          const label = el.querySelector('.diff-mode-label');
          if (label) {
            const labels = { overlay: 'Overlay', slider: 'Slider', difference: 'Difference' };
            label.textContent = labels[view] || 'Overlay';
          }

          // Update slider label
          const sliderLabel = el.querySelector('.slider-label-text');
          if (sliderLabel) {
            sliderLabel.textContent = view === 'slider' ? 'Slider position:' : 'Actual opacity:';
          }

          // Reset actual layer styles and slider
          const actualLayer = el.querySelector('.actual-layer');
          const slider = el.querySelector('.opacity-slider');
          if (actualLayer && slider) {
            // Clear inline styles so CSS takes over
            actualLayer.style.clipPath = '';
            actualLayer.style.opacity = '';
            slider.value = 50;
            const valueDisplay = el.querySelector('.opacity-value');
            if (valueDisplay) valueDisplay.textContent = '50%';
          }
        });
        // Update help text
        const helpText = document.querySelector('.help-text');
        if (view === 'difference') {
          helpText.textContent = 'Difference mode: black = identical, colored = different';
        } else if (view === 'slider') {
          helpText.textContent = 'Slider mode: drag to reveal expected vs actual';
        } else if (view === 'overlay') {
          helpText.textContent = 'Overlay mode: adjust opacity to compare';
        } else if (view === 'highlight') {
          helpText.textContent = 'Highlight mode: magenta cells differ (even by a tiny shade)';
        } else {
          helpText.textContent = '';
        }
      });
    });

    // Opacity/slider controls
    document.querySelectorAll('.opacity-slider').forEach(slider => {
      slider.addEventListener('input', (e) => {
        const comparison = e.target.closest('.comparison');
        const value = e.target.value;
        updateSlider(comparison, value);
      });
    });

    function updateSlider(comparison, value) {
      const actualLayer = comparison.querySelector('.actual-layer');
      const valueDisplay = comparison.querySelector('.opacity-value');
      if (comparison.classList.contains('view-slider')) {
        // Slider mode: clip-path
        actualLayer.style.clipPath = 'inset(0 ' + (100 - value) + '% 0 0)';
        actualLayer.style.opacity = '1';
        valueDisplay.textContent = value + '%';
      } else {
        // Overlay mode: opacity
        actualLayer.style.clipPath = '';
        actualLayer.style.opacity = value / 100;
        valueDisplay.textContent = value + '%';
      }
    }

    // Seen/minimized functionality
    // Gallery ID ensures seen state is scoped to this specific test run
    const GALLERY_ID = document.body.dataset.galleryId;
    const SEEN_STORAGE_KEY = 'terma-snapshot-seen-' + GALLERY_ID;

    function getSeenSnapshots() {
      try {
        return JSON.parse(localStorage.getItem(SEEN_STORAGE_KEY)) || {};
      } catch {
        return {};
      }
    }

    function saveSeenSnapshots(seen) {
      localStorage.setItem(SEEN_STORAGE_KEY, JSON.stringify(seen));
    }

    function updateSeenButton(comparison) {
      const btn = comparison.querySelector('.seen-btn');
      const isSeen = comparison.classList.contains('seen');
      btn.textContent = isSeen ? 'Mark as unseen' : 'Mark as seen';
    }

    // Initialize seen state from localStorage
    const seenSnapshots = getSeenSnapshots();
    document.querySelectorAll('.comparison').forEach(el => {
      const name = el.dataset.name;
      if (seenSnapshots[name]) {
        el.classList.add('seen');
      }
      updateSeenButton(el);
    });

    // Seen button click handlers
    document.querySelectorAll('.seen-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        const comparison = btn.closest('.comparison');
        const name = comparison.dataset.name;
        const seen = getSeenSnapshots();

        comparison.classList.toggle('seen');
        if (comparison.classList.contains('seen')) {
          seen[name] = true;
        } else {
          delete seen[name];
        }
        saveSeenSnapshots(seen);
        updateSeenButton(comparison);
      });
    });

    // Apply initial filter based on which button is active on page load
    const activeFilter = document.querySelector('.filter-btn.active');
    if (activeFilter && activeFilter.dataset.filter !== 'all') {
      const filter = activeFilter.dataset.filter;
      document.querySelectorAll('.comparison').forEach(el => {
        el.classList.toggle('hidden', el.dataset.status !== filter);
      });
    }
  </script>
</body>
</html>
